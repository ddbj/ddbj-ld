<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8" />
        <link rel="shortcut icon" href="../static/favicon.ico">
        <title>Metadata detail: [[${item.identifier}]]</title>
        <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.1.1/css/bootstrap.min.css}">
    </head>
    <style>
        .title {
            font-size: 25px;
            margin: 10px;
        }

        th {
            width: 150px;
        }
    </style>
    <script th:inline="javascript">
        let isOpen = false;
        let isLdOpen = false;

        const onClick = () => {
            isOpen = !isOpen;

            if(isOpen) {
                document.getElementById('viewProperties').textContent = '△';
                document.getElementById('properties').textContent = JSON.stringify([[${item.properties}]], null, 2);
            } else {
                document.getElementById('viewProperties').textContent = '▽';
                document.getElementById('properties').textContent = '{...}';
            }
        }

        const onClickLD = () => {
            isLdOpen = !isLdOpen;
            const properties = [[${item.properties}]]
            const design = properties.DESIGN ? properties.DESIGN : null;

            if(isLdOpen && design) {
                document.getElementById('viewLD').textContent = '△';
                document.getElementById('ld').textContent = JSON.stringify(design.LIBRARY_DESCRIPTOR, null, 2);
            } else {
                document.getElementById('viewLD').textContent = '▽';
                document.getElementById('ld').textContent = '{...}';
            }
        }
    </script>
    <body>
        <script src="https://www-preview.ddbj.nig.ac.jp/assets/js/ddbj_common_framework.js" id="DDBJ_common_framework" style=""></script>
        <div class="title">
            <a th:href="${@environment.getProperty('url.home')}"><span>home</span></a> > [[${item.type}]] > [[${item.identifier}]]
        </div>
        <table class="table table-striped table-hover" style="table-layout: initial;word-break: break-all;">
            <tbody>
                <tr>
                    <th class="bg-dark text-white">identifier</th>
                    <td>[[${item.identifier}]]</td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">type</th>
                    <td>[[${item.type}]]</td>
                </tr>
                <tr th:if="${item.type == 'bioproject' && #maps.containsKey(item.properties.Project.Project.ProjectType, 'ProjectTypeTopAdmin') && !#strings.isEmpty(item.properties.Project.Project.ProjectType.ProjectTypeTopAdmin)}">
                    <th class="bg-dark text-white">project type</th>
                    <td>Umbrella project</td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">sameAs</th>
                    <td>
                        <table>
                            <tbody>
                            <tr th:each="sameAs : ${item.sameAs}">
                                <th>[[${sameAs.key}]]　</th>
                                <td>
                                    <a
                                            target="_blank"
                                            th:each="same : ${sameAs.value}"
                                            th:href="${same.url}"
                                            th:text="${same.identifier}"
                                            th:style="'margin-right: 10px'"
                                    />
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">organism</th>
                    <td>
                        <th:block th:if="${!#strings.isEmpty(item.organism)}">
                            <a
                                    target="_blank"
                                    th:if="${!#strings.isEmpty(item.organism.name)}"
                                    th:href="'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=' + ${item.organism.identifier}"
                                    th:text="${item.organism.name}"
                            />
                            <a
                                    target="_blank"
                                    th:if="${#strings.isEmpty(item.organism.name)}"
                                    th:href="'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?id=' + ${item.organism.identifier}"
                                    th:text="${item.organism.identifier}"
                            />
                        </th:block>
                    </td>
                </tr>
                <tr th:if="${item.type == 'bioproject' && !#strings.isEmpty(item.properties.Project.Project.ProjectDescr)}">
                    <th class="bg-dark text-white">title</th>
                    <td>[[${item.properties.Project.Project.ProjectDescr.Title}]]</td>
                </tr>
                <tr th:if="${item.type == 'bioproject' && !#strings.isEmpty(item.properties.Project.Project.ProjectDescr)}">
                    <th class="bg-dark text-white">description</th>
                    <td th:utext="${item.properties.Project.Project.ProjectDescr.Description}"></td>
                </tr>
                <tr th:if="${item.type == 'bioproject' && !#strings.isEmpty(item.properties.Project.Project.ProjectType) && #maps.containsKey(item.properties.Project.Project.ProjectType, 'ProjectTypeSubmission') && #maps.containsKey(item.properties.Project.Project.ProjectType.ProjectTypeSubmission, 'ProjectDataTypeSet')}">
                    <th class="bg-dark text-white">data type</th>
                    <td th:each="dataType : ${item.properties.Project.Project.ProjectType.ProjectTypeSubmission.ProjectDataTypeSet.DataType}">
                        <span>[[${dataType}]]</span>
                    </td>
                </tr>
                <tr th:if="${item.type == 'bioproject' && #maps.containsKey(item.properties.Project, 'Submission') && !#strings.isEmpty(item.properties.Project.Submission) && !#strings.isEmpty(item.properties.Project.Submission.Description)}">
                    <th class="bg-dark text-white">organization</th>
                    <td>
                        <div th:each="org : ${item.properties.Project.Submission.Description.Organization}">
                            <span th:if="${!#maps.containsKey(org, 'url') && #strings.isEmpty(org.url)}">[[${org.Name.content}]]</span>
                            <a target="_blank" th:if="${#maps.containsKey(org, 'url') && !#strings.isEmpty(org.url)}" th:href="${org.url}" th:text="${org.Name.content}" />
                        </div>
                    </td>
                </tr>
                <tr th:if="${item.type == 'biosample' && !#strings.isEmpty(item.properties.Attributes)}">
                    <th class="bg-dark text-white">attributes</th>
                    <td>
                        <table>
                            <tbody>
                            <tr th:each="attribute : ${item.properties.Attributes.Attribute}">
                                <th>[[${attribute.attribute_name}]]　</th>
                                <td>[[${attribute.content}]]</td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr th:if="${item.type == 'bioproject'}">
                    <th class="bg-dark text-white">publication</th>
                    <td>
                        <div th:each="pub : ${item.publication}">
                            <a
                                target="_blank"
                                th:href="${pub.url}"
                                th:text="${pub.title}"
                            />
                        </div>
                        <a
                            target="_blank"
                            th:if="${item.hasMorePublication}"
                            th:text="More"
                            th:href="${item.searchURL}"
                        />
                    </td>
                </tr>
                <tr th:if="${item.type == 'bioproject'  && !#strings.isEmpty(item.properties.Project.Project.ProjectDescr) && #maps.containsKey(item.properties.Project.Project.ProjectDescr, 'Grant') && !#strings.isEmpty(item.properties.Project.Project.ProjectDescr.Grant)}">
                    <th class="bg-dark text-white">grant</th>
                    <td>
                        <div th:each="grant : ${item.properties.Project.Project.ProjectDescr.Grant}">
                            [[${grant.Title}]] By [[${grant.Agency.content}]]
                        </div>
                    </td>
                </tr>
                <tr th:if="${item.type == 'bioproject'  && #maps.containsKey(item.properties.Project.Project.ProjectDescr, 'ExternalLink') && !#strings.isEmpty(item.properties.Project.Project.ProjectDescr.ExternalLink)}">
                    <th class="bg-dark text-white">external link</th>
                    <td>
                        <div th:each="external : ${item.properties.Project.Project.ProjectDescr.ExternalLink}">
                            <a
                                    target="_blank"
                                    th:if="${!#strings.isEmpty(external.label)}"
                                    th:href="${external.URL}"
                                    th:text="${external.label}"
                            />
                            <a
                                    target="_blank"
                                    th:if="${#strings.isEmpty(external.label)}"
                                    th:href="${external.URL}"
                                    th:text="${external.URL}"
                            />
                        </div>
                    </td>
                </tr>
                <tr th:if="${item.type == 'sra-sample' && !#strings.isEmpty(item.properties.SAMPLE_ATTRIBUTES)}">
                    <th class="bg-dark text-white">attributes</th>
                    <td>
                        <table>
                            <tbody>
                            <tr th:each="attribute : ${item.properties.SAMPLE_ATTRIBUTES.SAMPLE_ATTRIBUTE}">
                                <th>[[${attribute.TAG}]]　</th>
                                <td>[[${attribute.VALUE}]]</td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr th:if="${item.type == 'sra-experiment'}">
                    <th class="bg-dark text-white">title</th>
                    <td>[[${item.properties.TITLE}]]</td>
                </tr>
                <tr th:if="${item.type == 'sra-experiment' && !#strings.isEmpty(item.properties.DESIGN)}">
                    <th class="bg-dark text-white">library descriptor　<span id="viewLD" onclick="onClickLD()">▽</span></th>
                    <td>
                        <pre id="ld" style="white-space: pre-wrap">{...}</pre>
                    </td>
                </tr>
                <tr th:if="${item.type == 'sra-experiment' && !#strings.isEmpty(item.properties.PLATFORM)}">
                    <th class="bg-dark text-white">instrument model</th>
                    <td>
                        <table>
                            <tbody>
                                <tr th:each="platform : ${item.properties.PLATFORM}">
                                    <th>[[${platform.key}]] </th>
                                    <td>[[${platform.value.INSTRUMENT_MODEL}]]</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">properties　<span id="viewProperties" onclick="onClick()">▽</span></th>
                    <td>
                        <pre id="properties" style="white-space: pre-wrap">{...}</pre>
                    </td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">dbXrefs</th>
                    <td>
                        <table>
                            <tbody>
                            <tr th:each="dbXrefs : ${item.dbXrefs}">
                                <th>[[${dbXrefs.key}]]　</th>
                                <td>
                                    <a
                                        target="_blank"
                                        th:each="dbXref : ${dbXrefs.value.dbXrefs}"
                                        th:href="${dbXref.url}"
                                        th:text="${dbXref.identifier}"
                                        th:style="'margin-right: 10px'"
                                    />
                                    <a
                                        target="_blank"
                                        th:if="${dbXrefs.value.hasMore}"
                                        th:text="More"
                                        th:href="${item.searchURL}"
                                    />
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">distribution</th>
                    <td>
                        <a
                                target="_blank"
                                th:each="dist : ${item.distribution}"
                                th:href="${dist.contentUrl}"
                                th:text="${dist.encodingFormat}"
                                th:style="'margin-right: 10px'"
                        />
                    </td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">Download</th>
                    <td>
                        <table>
                            <tbody>
                                <tr th:each="download : ${item.downloadUrl}">
                                    <th th:if="${!#strings.isEmpty(download.name)}" nowrap="nowrap">[[${download.name}]]　</th>
                                    <td>
                                        <a target="_blank" th:if="${!#strings.isEmpty(download.url) && download.isExists}" th:href="${download.url}" th:text="HTTPS" th:style="'margin-right: 10px'" />
                                        <a target="_blank" th:if="${!#strings.isEmpty(download.ftpUrl) && download.isExists}" th:href="${download.ftpUrl}" th:text="FTP" th:style="'margin-right: 10px'" />
                                        <a target="_blank" th:if="${!#strings.isEmpty(download.url) && !download.isExists}" th:href="${download.url}" th:text="HTTPS" th:style="'margin-right: 10px;pointer-events: none;color:#808080;'" />
                                        <a target="_blank" th:if="${!#strings.isEmpty(download.ftpUrl) && !download.isExists}" th:href="${download.ftpUrl}" th:text="FTP" th:style="'margin-right: 10px;pointer-events: none;color:#808080;'" />
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">status</th>
                    <td>[[${item.status}]]</td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">visibility</th>
                    <td>[[${item.visibility}]]</td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">dateCreated</th>
                    <td>[[${item.dateCreated}]]</td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">dateModified</th>
                    <td>[[${item.dateModified}]]</td>
                </tr>
                <tr>
                    <th class="bg-dark text-white">datePublished</th>
                    <td>[[${item.datePublished}]]</td>
                </tr>
            </tbody>
        </table>
    </body>
</html>
